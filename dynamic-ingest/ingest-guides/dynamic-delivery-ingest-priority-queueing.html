---
title: '動態交付攝取優先隊列'
description: '本主題介紹如何使用優先級設置來優化高優先級視頻的攝取時間。'
parent: 'Ingest Guides' 
grandparent: Dynamic Ingest API
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>
    <section class="bcls-section">
    <h2 id="Introduction">介紹</h2>
    
    <p>動態投放收錄現在具有一項稱為<strong>優先排隊</strong>允許發布者以所需的優先級設置向我們提交提取作業，以影響處理作業的順序和及時性。</p>
    
    <aside>
    <p>請注意，優先隊列僅適用於已啟用以下功能的帳戶<a href="/dynamic-ingest/getting-started/overview-dynamic-ingest-api-dynamic-delivery.html">動態投放</a>。不能在使用舊版提取系統的帳戶中使用它。</p>
    
    </aside>
    </section>
    
    <section class="bcls-section">
    <h2 id="how-dynamic-delivery-ingestion-currently-works">動態傳遞攝取隊列如何工作</h2>
    
    <p>使用正常優先級排隊時，Dynamic Delivery Ingestion 限制為每個帳戶 100 個活動作業。當超過該限制時，攝取系統會將額外的請求排隊以供稍後處理。隊列的大小有一個單獨的限制，當達到這個限制時，它將拒絕將攝取請求返回給客戶（帶有 429 錯誤代碼）。當作業完成時，容量將被釋放，排隊的作業將按照收到的順序一次一個地被拾取和處理。</p>
    
    <p>中的視頻狀態<span translate="No">內容管理系統 API</span>不反映作業已排隊 - 狀態將為<code translate="No">pending </code>作業是否正在處理或排隊。</p>
    </section>
    
    <section class="bcls-section">
    <h2 id="How_Priority_Queueing_affects_ingestion">優先隊列如何影響攝取</h2>
    
    <p>優先級排隊允許用戶添加一個<code translate="No">priority </code>標記為攝取請求。允許值<code translate="No">priority </code>是<code translate="No">low </code>和<code translate="No">normal </code> .任何其他值都將導致請求被拒絕，並帶有422錯誤代碼。當用戶未指定任何優先級時，默認值為<code translate="No">normal </code>用來。這是優先級隊列如何更改從隊列處理作業的方式的簡要說明：</p>
    
    <ol>
      <li>如果沒有排隊的作業，並且有運行作業的能力，則該作業將立即運行。這適用於低優先級和正常優先級作業。</li>
      <li>如果沒有容量可運行其他作業，則將該作業排隊。</li>
      <li>如果隊列中有作業，則所有新作業也將排隊。這意味著新作業無法在排隊作業之前啟動。</li>
      <li>當有能力運行另一個作業並且有排隊的作業時，從隊列中取出一個作業：
      <ul>
        <li>如果隊列中有任何常規優先級作業，則將選擇最早的常規優先級作業。</li>
        <li>如果隊列中沒有正常優先級的作業，則將選擇最早的低優先級作業。</li>
      </ul>
      </li>
      <li>普通和低優先級作業被視為<strong>相同的</strong>有多少個正在運行的工作。無論優先級如何，處理的作業總數限制為每個帳戶 100 個。</li>
      <li>有<strong>分離</strong>可以排隊多少正常和低優先級作業的配額。</li>
    </ol>
    </section>
    
    <section class="bcls-section">
    <h2 id="What_to_watch_out_for">需要注意什麼</h2>
    
    <h3>提交工作後，翻譯詳細信息已更改</h3>
    
    <p>創建動態攝取作業時，動態攝取系統會復制指定的攝取配置文件，並且該配置文件<strong>複製</strong>即使在提交作業後已修改配置文件，也將用於處理。</p>
    
    <p>對於低優先級的工作，在某些情況下，處理可能會延遲很長時間，<strong>該配置文件中指定的格式可以修改</strong>在實際處理作業之前。如果發生這種情況，則用於處理視頻的演繹將是<strong>新的</strong>這些演繹的定義；而不是提交作業時的格式定義。</p>
    
    <p>如果你想<strong>保證</strong>你得到了移交<strong>如提交工作時所指定的</strong>，您應該複製副本，並創建一個引用這些副本的新配置文件，然後開始提取過程。（如果視頻已經放入Video Cloud中，則可以使用更新後的配置文件對視頻進行重新轉碼。請記住，在完成對原始作業的處理之前，您無法對視頻進行重新轉碼。）</p>
    
    <h3>源文件上傳</h3>
    
    <p>源文件上傳將在 24 小時後刪除該 S3 存儲桶中的文件。由於在某些情況下處理低優先級作業的時間可能不會超過 24 小時，因此文件可能已被刪除，在這種情況下處理將失敗。<strong>我們不建議將低優先級攝取用於源文件上傳</strong> .</p>
    </section>
    
    <section class="bcls-section">
    <h2 id="sample_request">示例請求</h2>
    
    <p>以下是優先級較低的攝取請求主體的示例：</p>
    
    <pre class="line-numbers">
    <code class="language-json" translate="No">{
    "master": {
    "url": "http://host/master.mp4"
    },
    "profile": "multi-platform-extended-static",
    <span class="bcls-highlight">"priority": "low"</span>,
    "callbacks": [
    "http://mydomain.com/di-callbacks.php"
    ]
    }
    </code>
    </pre>
    
    <p>以下是正常優先級工作的示例：</p>
    
    <pre class="line-numbers">
    <code class="language-json" translate="No">{
    "master": {
    "url": "http://host/master.mp4"
    },
    "profile": "multi-platform-extended-static",
    <span class="bcls-highlight">"priority": "normal"</span>,
    "callbacks": [
    "http://mydomain.com/di-callbacks.php"
    ]
    }
    </code>
    </pre>
    
    <p>注意，因為<code translate="No">normal </code>是默認值，則上一個請求的處理方式與下一個完全相同：</p>
    
    <pre class="line-numbers">
    <code class="language-json" translate="No">{
    "master": {
    "url": "http://host/master.mp4"
    },
    "profile": "multi-platform-extended-static",
    "callbacks": [
    "http://mydomain.com/di-callbacks.php"
    ]
    }
    </code>
    </pre>
    </section>
    
    <section class="bcls-section">
    <h2 id="Using_the_priority_queue">使用優先隊列</h2>
    
    <p>從上一節的最後一個示例中可以清楚地看出，如果您這樣做，<strong>不是</strong>使用<code translate="No">priority </code>提取作業中的“字段"，它們將繼續按原樣進行處理。</p>
    
    <p>的添加<code translate="No">priority </code>領域將主要在以下情況下使您受益：</p>
    
    <ol>
      <li>您攝取了相當多的視頻</li>
      <li>獲得 <em>一些</em> 盡快將您的視頻在線發布，同時不急於發布其他視頻（因為內容不那麼重要，或者您不打算立即發布視頻）</li>
      <li>您有想要重新轉碼的視頻，但您不希望這會減慢新內容的攝取速度</li>
    </ol>
    </section>
    
    <section class="bcls-section">
    <h2 id="How_low_priority_queue_works">低優先級隊列如何工作</h2>
    
    <p>本節說明低優先級隊列的工作原理。</p>
    
    <p>無法保證正常或低優先級作業何時開始。但是，正常優先級的作業將始終在低優先級的作業之前啟動。</p>
    
    <p>如果您以穩定，快速的速度提交正常優先級的作業，則可能需要花費大量時間才能啟動低優先級的作業。</p>
    
    <p>與同一視頻的正常優先級相比，低優先級的作業可能要花更長的時間啟動並且也需要更長的處理時間。</p>
    </section>
    </article>
 