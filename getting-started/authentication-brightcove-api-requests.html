---
title: 'API 請求的身份驗證'
description: '本主題涵蓋對 Brightcove REST API 請求的身份驗證。'
parent: General 
grandparent: Home
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>
  <section class="bcls-section">
    <h2 id="Introduction">介紹</h2>

    <p>大多數Brightcove REST API都使用OAuth2作為身份驗證的基礎，我們將在以下各節中更詳細地介紹OAuth實現。</p>

    <p>但是，首先請注意，兩個API使用不同的身份驗證方法：</p>

    <section class="bcls-subsection">
      <h3 id="policy_key">策略密鑰認證：播放接口</h3>

      <p>這<a href="/playback/index.html">播放接口</a>主要用於從播放器或門戶網站檢索視頻和播放列表數據，使用<code translate="No">policy_key</code>，用於身份驗證，通常作為參數傳遞<code translate="No">Accept</code>標題：</p>

      <pre>
        <code class="language-http" translate="No">Accept: application/json;pk={policy_key}</code></pre>

      <p>策略密鑰是為Brightcove播放器自動生成的，可以從<a href="/policy/getting-started/policy-keys.html#Getting_the_policy_key">播放器配置</a>，或使用<a href="/policy/index.html">政策API</a></p>
    </section>

    <section class="bcls-subsection">
      <h3 id="authentication_api_key">API密鑰身份驗證：實時 API</h3>

      <p>這<a href="https://live.support.brightcove.com/live-api/">實時 API</a>使用在您設置帳戶以驗證請求時提供的 API 密鑰。API 密鑰在一個<code translate="No">X-API-KEY</code>標題：</p>

      <pre>
        <code class="language-http" translate="No">X-API-KEY : {YOUR_APIKey}</code></pre>
    </section>
  </section>

  <section class="bcls-section">
    <h2 id="oauth2_authentication">OAuth2身份驗證</h2>

    <p>Video Cloud 的其他 REST API 使用 OAuth2 進行身份驗證，對於熟悉 OAuth2 的人，我們使用客戶端憑據流。涉及兩個操作：</p>

    <ol>
      <li><strong>獲取客戶憑證：</strong>這是一次性操作，最容易使用<strong>API認證</strong> Studio中管理工具的頁面。看<a href="/general/managing-api-authentication-credentials.html">管理 API 身份驗證憑據</a>有關詳細信息和分步說明。</li>
      <li><strong>獲取訪問令牌：</strong>每個API請求都必須包含一個訪問令牌，該訪問令牌以<code translate="No">Authorization</code>標頭：
        <pre>
        <code class="language-http" translate="No">Authorization: Bearer {access_token}</code></pre>

        <p>訪問令牌的有效期為5分鐘，因此，除非您運行的進程將生成重複的API請求，否則您可能只想為每個請求獲取一個新的令牌。</p>

        <p>通過向Brightcove的OAuth API發送請求中的客戶端憑據來獲得訪問令牌。看<a href="/oauth/guides/getting-access-tokens.html">獲取訪問令牌</a>詳細信息。還有一個<a href="/oauth/code-samples/oauth-api-sample-get-access-token.html">示例應用程序</a>您可以使用獲取一次性令牌來測試 API 調用。還有配置流行的 REST 客戶端的說明<a href="/general/use-postman-api-requests.html">郵差</a>和<a href="/general/use-insomnia-api-requests.html">失眠</a> .</p>
      </li>
    </ol>
  </section>
  <section class="bcls-section" id="stepsGetCredentials">
    <h2>通過OAuth API的客戶端憑據</h2>

    <p>如果您希望或需要使用OAuth API創建客戶端憑據，則以下步驟將指導您獲取客戶端憑據。您首先需要獲取您的 BC_TOKEN，它用於針對客戶端憑據請求對您進行身份驗證。</p>

    <h3>拿你的<code translate="No">BC_TOKEN</code>和帳號</h3>

    <p>您需要登錄 Studio 以獲取您的<code translate="No">BC_TOKEN</code> .</p>

    <ol class="bcls-tasklist">
      <li>照常登錄Studio。</li>
      <li>您需要您的帳號（在 Studio 中稱為發布商 ID），您可以通過在 Studio 中轉到您的帳戶信息來獲取該帳號：
        <figure class="bcls-figure"><img class="bcls-image" alt="Account ID" src="/assets/images/getting-started/account-info-studio.png" />
          <figcaption class="bcls-caption--image">帳戶ID</figcaption>
        </figure>
      </li>
      <li>打開 Studio 中的任何頁面，打開瀏覽器的開發人員工具，轉到控制台，然後粘貼以下代碼：
        <pre class="line-numbers">
      <code class="language-javascript" translate="No">var cookiesArray = document.cookie.split(";"), cookiesObj = {}, i, tmpArray = [];
      for (i = 0; i &lt; cookiesArray.length; i++) {
          tmpArray = cookiesArray[i].split("=");
          if (tmpArray[0].indexOf('BC_TOKEN') &gt; -1) {
              cookiesObj.BC_TOKEN = tmpArray[1];
          }
      }
      window.prompt("BC_TOKEN:", cookiesObj.BC_TOKEN);</code></pre>

        <p>...然後按回車鍵。</p>
      </li>
      <li>您應該會看到一個提示，其中包含您的<code translate="No">BC_TOKEN</code>：
        <figure class="bcls-figure"><img class="bcls-image" alt="BC_TOKEN" src="/assets/images/getting-started/prompt-with-token-safari.png" />
          <figcaption class="bcls-caption--image">BC_TOKEN</figcaption>
        </figure>
      </li>
      <li>如果您有BC_TOKEN，請繼續<a href="#getCredentials">獲取客戶憑證</a>部分;如果由於某些原因您沒有使用前面的步驟獲取BC_TOKEN，只需轉到控制台，鍵入<code translate="No">document.cookies</code>，然後按回車鍵。</li>
      <li>該頁面的所有cookie將以分號分隔的列表形式返回。在列表中找到BC_TOKEN cookie，然後復制值：
        <figure class="bcls-figure"><img class="bcls-image" alt="Get BC_TOKEN from Console" src="//learning-services-media.brightcove.com/doc-assets/video-cloud-apis/ingest-profiles-api/guides/get-access-token-console.png" />
          <figcaption class="bcls-caption--image">從控制台獲取BC_TOKEN</figcaption>
        </figure>
      </li>
    </ol>

    <h3 id="getCredentials">得到<code translate="No">client_credentials</code></h3>

    <p>現在，我們準備調用OAuth服務以檢索客戶端憑據。我們必須指定我們為其請求憑據的客戶端應用程序名稱 - 該名稱是任意的，旨在幫助您跟踪憑據的用途 - 這裡我們將僅使用“ingest-profiles-api-client”。我們還必須在數組中指定我們想要訪問的操作的範圍，這裡我們將使用。可用的操作顯示在<a href="/oauth/guides/api-operations-client-credentials-requests.html">客戶端憑據請求的 API 操作</a> .在以下步驟中，您將指定Ingest Profiles API所需的操作。</p>

    <ol class="bcls-tasklist">
      <li>編輯以下curl命令，然後將其粘貼到命令行中並按<strong>返回</strong>。您必須為以下三個值提供特定值：

        <ul>
          <li><em><strong>你的 BC_TOKEN</strong></em></li>
          <li><em><strong>您的憑證名稱</strong></em></li>
          <li><em><strong>你的賬號</strong></em></li>
        </ul>

        <pre class="line-numbers">
      <code class="language-bash" translate="No">curl \
        --include \
        --header "Authorization: BC_TOKEN <em><strong>your_BC_TOKEN</strong></em>" \
        --data 'name=ingest-profiles-api-client&amp;maximum_scope=[{
            "identity": {
              "type": "video-cloud-account",
              "account-id": <em><strong>your_account_id</strong></em>
            },
            "operations": [
                  "video-cloud/ingest-profiles/profile/read",
                  "video-cloud/ingest-profiles/profile/write",
                  "video-cloud/ingest-profiles/account/read",
                  "video-cloud/ingest-profiles/account/write"
              ]
          }]' \
      https://oauth.brightcove.com/v4/client_credentials</code></pre>
      </li>
      <li>響應應如下所示（已添加格式）：
        <pre class="line-numbers">
      <code class="language-json" translate="No">{
        "redirect_url": null,
        "maximum_scope": [
          {
            "identity": {
              "type": "video-cloud-account",
              "account-id": your_video_cloud_account_id
            },
            "operations": [
              "video-cloud/ingest-profiles/profile/write",
              "video-cloud/ingest-profiles/account/write",
              "video-cloud/ingest-profiles/profile/read",
              "video-cloud/ingest-profiles/account/read"
            ]
          }
        ],
        "name_html": "ingest-profiles-api-client",
        "issued_to": "your_email@host.com",
        "trusted": null,
        "expires_at": null,
        "issued_at": "2015-06-01T15:09:00Z",
        "name": "ingest-profiles-api-client",
        "description_html": null,
        "revoked": null,
        "type": "credential",
        "client_secret": "Ifckr6cWtxOh_NZnEVhKCgcqZaqoMcPuoJ-VGuivIE_psPoPUt2hGqUK15uPON3x3m748ElazZoOKPxbI3-4nQ",
        "description": null,
        "client_id": "da270d86-f3cd-4ee6-85b0-047df97a0db2",
        "issued_user": your_video_cloud_account_id
      }</code></pre>
      </li>
      <li>複製並保存<code translate="No">client_id</code>和<code translate="No">client_secret</code>，因為您隨時都需要這些，<code translate="No">access_token</code>。</li>
    </ol>
  </section>

  <section class="bcls-section" id="accessToken">
    <h2>通過OAuth API訪問令牌</h2>

    <p>訪問令牌與客戶端憑據不同，它是短暫的-當前它們在5分鐘內過期。您需要為每個 API 請求獲取一個新請求。當然，您可以在應用程序中構建邏輯以檢查最近的訪問令牌以查看它是否已超時，但對 Ingest Profiles API 的請求可能很少，因此沒有充分的理由這樣做.</p>

    <p>實際上，您可能很少使用該API，因此根本不值得使用它來構建應用程序。一種替代方法是使用<a href="/assets/downloads/api-tester.sh.zip">這個shell腳本</a> Brightcove學習服務所建立的。它允許您輸入客戶端ID和密碼，API請求和方法以及任何請求數據。然後得到一個<code translate="No">access_token</code>，發出API請求，然後輸出響應。（請注意，shell腳本使用的是cURL，該URL本機安裝在Mac MacOS和其他Unix / Linux系統上，或者<a href="https://general.support.brightcove.com/developer/concepts-set-curl.html">可以安裝在Windows上</a>。</p>

    <p>要檢索訪問令牌，您可以向以下對象發出 POST 請求：</p>

    <pre class="line-numbers">
      <code class="language-http" translate="No">https://oauth.brightcove.com/v4/access_token</code></pre>

    <p>您必須通過此調用傳遞以下標頭：</p>

    <ul>
      <li><code translate="No">Content-Type: application/x-www-form-urlencoded</code></li>
      <li><code translate="No">Authorization: Basic {client_id}:{client_secret}</code></li>
    </ul>

    <p>整個<code translate="No">{client_id}:{client_secret}</code>字符串必須是 Base64 編碼的（如果您將字符串作為<code translate="No">--user</code>證書;在其他語言中，您需要自己處理 Base64 編碼）。</p>

    <p>您還必須將以下鍵/值對作為請求正文或 URL 參數發送：</p>

    <pre class="line-numbers">
      <code class="language-bash" translate="No">grant_type=client_credentials</code></pre>

    <p>響應看起來像這樣（為了便於閱讀，這裡打印得很漂亮）：</p>

    <pre class="line-numbers">
      <code class="language-json" translate="No">{
          "access_token": <strong>"ANB7xKhiUZmwltVd3f1odcHHM9VAwg02kwmLwtZwHv3SxGCOWLUf5W4G7X22PRjmR9StvFUqzpVZ1suOfyfOigdi-rnohxyEaSSuZceeLw_9OBW7fXldOG05HEgkeK3N-DBZZZyilodmjA1JWZHbgI3IU7Rmz5IPGyi-sDxHN3KlOr1BDZlLZpXPdFPwEyb6idq-z8AL-blKTSMtNI3_fz3oNBisfrHGUv5tXHoQT4B7FYcvdrap16gTOO7_wNt1zmgLJiUHvyxZgsgBchm_AhohVL-AYgcfCbCR0v7d2hgI4ag35pnZNeujDiBLfnCFcVMlqQGq8UEVZrmU9a8y4pVAGih_EImmghqmSrkxLPYZ800-vIWX-lw"</strong>,
          "token_type": "Bearer",
          "expires_in": 300
      }</code></pre>

    <p>這<code translate="No">access_token</code>值是你必須傳入的<code translate="No">Authorization</code>帶有這種形式的 API 調用的標頭：</p>

    <pre class="line-numbers">
      <code class="language-bash" translate="No">Authorization: Bearer {access_token}</code></pre>

    <p>這<code translate="No">expired_in</code> value 是訪問令牌有效的秒數。</p>

    <p>有關更多信息和示例代碼，請參見<a href="/oauth/guides/getting-access-tokens.html">獲取訪問令牌</a></p>
  </section>
</article>