---
title: '一步步：交付系統API'
description: '本文檔提供了使用 Delivery System API 創建存儲庫 (repo) 的動手介紹，您將在該存儲庫中保存和更新插件。'
parent: Delivery System API 
grandparent: Home
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
    <summary>{{ page.description }}</summary>
    <section id="Overview" class="bcls-section">
        <h2>概述</h2>

        <p>這是您將執行的步驟：</p>

        <ul>
            <li>使用交付系統API創建存儲庫</li>
            <li>創建用於存儲文件的本地文件夾</li>
            <li>創建一個插件並將其複製到倉庫</li>
            <li>更改播放器以使用新插件</li>
            <li>更改插件並觀察玩家使用更改後的插件</li>
        </ul>

        <p class="BCL-aside">筆記：如果您是經驗豐富的Git用戶，您將看到一些API調用執行與您在Git中相同的功能。實際上，某些文件操作API調用只是執行Git命令。</p>
    </section>

    <section id="prerreqs" class="bcls-section">
        <h2>先決條件</h2>

        <div class="BCL-concept">
            <p>要開始這些分步說明，假設您已完成<a href="/player-management/getting-started/step-step-player-management.html">一步步：球員管理</a>。通過完成上述活動，您已經在命令行系統中定義了以下環境變量：</p>

            <ul>
                <li>{account_id}</li>
                <li>$EMAIL</li>
                <li>{player_id}</li>
            </ul>
        </div>
    </section>

    <section id="createrepo" class="bcls-section">
        <h2>創建倉庫</h2>

        <div class="BCL-concept">
            <p>您現在將使用 Delivery System API 創建存儲庫並將文件複製到該存儲庫。創建存儲庫後，您還可以使用API列出存儲庫，顯示存儲庫的詳細信息，刪除存儲庫等，但是在許多工作流程中，這不是必需的。</p>

            <p>在curl語句中創建新的倉庫，您將使用HTTP <code translate="No">PUT</code>方法，並在URL中包含新存儲庫的名稱。執行此curl語句以創建一個名為repo的存儲庫<code translate="No">firstRepo</code>。</p>

            <pre class="line-numbers">
    <code class="language-bash" translate="No">curl \
      --user $EMAIL \
      --request PUT \
      https://repos.api.brightcove.com/v1/accounts/{account_id}/repos/firstRepo
    </code></pre>
            <!-- <code data-gist-id="8939637" data-gist-hide-footer="true" data-gist-line="1-5"></code><br /> -->

            <p>您將收到確認存儲庫創建的響應。響應將顯示：存儲庫的名稱和公共 URL。</p>

            <ul>
                <li>名稱：回購名稱</li>
                <li>public_url：存儲庫的公共 URL</li>
                <li>repo_url：存儲庫 URL</li>
            </ul>

            <pre class="line-numbers">
    <code class="language-json" translate="No">{
      "name": "firstRepo",
      "public_url": "http://players.brightcove.net/1507807800001/firstRepo",
      "repo_url": "https://repos.api.brightcove.com/v1/accounts/1507807800001/repos/firstRepo"
    }</code></pre>
            <!-- <code data-gist-id="8939637" data-gist-hide-footer="true" data-gist-line="7-11"></code> -->
        </div>
    </section>

    <section id="connectrepofolder" class="bcls-section">
        <h2>創建文件夾</h2>

        <div class="BCL-concept">
            <p>接下來，您需要在計算機上本地創建一個文件夾，用於存儲與Brightcove Player關聯的文件。在您選擇的位置創建文件夾，然後移動（<code translate="No">cd</code>）放入該文件夾。</p>

            <pre class="line-numbers">
    <code class="language-bash" translate="No">mkdir firstRepo
    cd firstRepo</code></pre>
            <!-- <code data-gist-id="8939637" data-gist-hide-footer="true" data-gist-line="13-14"></code><br /> -->
        </div>
    </section>

    <section id="createplugin" class="bcls-section">
        <h2>創建插件</h2>

        <p>現在，您將在文件夾中創建一個插件以復製到倉庫。使用 Step-by-Step 中的相同插件：播放器管理，但更改顯示的文本除外。創建文件，將下面的文本粘貼到文件中，然後保存。使用與 Step-by-Step 中使用的文件名相同的文件名：玩家管理，<code translate="No">first-plugin.js</code>。</p>

        <pre class="line-numbers">
    <code class="language-javascript" translate="No">videojs.registerPlugin('firstPlugin', function() {
      var player = this,
      overlay = document.createElement('p');
      overlay.className = 'vjs-overlay';
      overlay.innerHTML = "NEW TEXT!";
      player.el().appendChild(overlay);
    });</code></pre>
        <!-- <p><code data-gist-id="8939637" data-gist-hide-footer="true" data-gist-line="19-25"></code></p> -->

        <p>您現在將新創建的插件文件複製到存儲庫。使用以下 cURL 語句來執行此任務。</p>

        <pre class="line-numbers">
    <code class="language-bash" translate="No">curl \
      --user $EMAIL \
      --form contents=@first-plugin.js \
      --request PUT \
      https://repos.api.brightcove.com/v1/accounts/{account_id}/repos/firstRepo/files/first-plugin.js</code></pre>
        <!-- <p><code data-gist-id="8939637" data-gist-hide-footer="true" data-gist-line="113-117"></code></p> -->

        <p>複製後，您應該看到類似於以下內容的確認：</p>

        <pre class="line-numbers">
    <code class="language-json" translate="No">{
      "name": "first-plugin.js",
      "public_url": "http://players.brightcove.net/1507807800001/firstRepo/first-plugin.js"
    }</code></pre>
        <!-- <p><code data-gist-id="8939637" data-gist-hide-footer="true" data-gist-line="119-122"></code></p> -->

        <p>您可以通過使用以下 cURL 語句查看其內容來確認文件是否被正確複製。</p>

        <pre class="line-numbers">
    <code class="language-bash" translate="No">curl http://players.brightcove.net/{account_id}/firstRepo/first-plugin.js</code></pre>
        <!-- <p><code data-gist-id="8939637" data-gist-hide-footer="true" data-gist-line="125"></code></p> -->

        <p>您還可以通過瀏覽<code translate="No">public_url</code>從文件副本返回。</p>

        <aside class="bcls-aside bcls-aside--information">如果您對插件進行更改，則可能會延遲查看結果，因為通過 Delivery System API 託管的所有文件都需要進行五分鐘的緩存。這意味著在您的插件被讀取和使用之前最多可能需要五分鐘。如果這是您的初始測試，則不會有任何延遲。</aside>
    </section>

    <section id="usenewplugin" class="bcls-section">
        <h2>使用新插件</h2>

        <div class="BCL-concept">
            <p>在分步中：播放器管理您使用curl語句告訴播放器插件JavaScript代碼的位置，以及CSS位置和插件名稱。您將再次執行相同的操作，但這次插件的路徑將使用在文件副本響應中找到的新路徑（如復制響應中的第 2 行所示）。執行以下curl語句以指向新的插件位置。</p>

            <aside class="bcls-aside bcls-aside--information">筆記：即使您沒有提供任何選項，您仍然必須輸入插件的名稱，如下所示。</aside>

            <pre class="line-numbers">
    <code class="language-bash" translate="No">curl \
      --header "Content-Type: application/json" \
      --user $EMAIL \
      --request PATCH \
      --data '{
        "scripts": [
          "http://players.brightcove.net/{account_id}/firstRepo/first-plugin.js"
        ],
        "stylesheets": [
          "http://solutions.brightcove.com/bcls/video-js/new-player/first-plugin.css"
        ],
        "plugins": [{
          "name": "firstPlugin"
        }]
      }' \
      https://players.api.brightcove.com/v2/accounts/{account_id}/players/{player_id}/configuration</code></pre>
            <!-- <code data-gist-id="8939637" data-gist-hide-footer="true" data-gist-line="50-65"></code><br /> -->

            <aside class="bcls-aside bcls-aside--tip">最好的做法是將 CSS 文件也保存在 repo 中。為簡單起見，在這種情況下沒有這樣做。另外，您可能只更新了<code translate="No">scripts</code>的部分<code translate="No">data</code> curl語句的一部分，因為它是唯一要更改的部分。為了審查，<code translate="No">scripts</code> , <code translate="No">stylesheets</code>和<code translate="No">plugins</code>部分已更新。</aside>

            <p>使用返回的<code translate="No">preview_url</code>瀏覽播放器，您將看到顯示的插件中的新文本。如果選擇，還可以發布播放器並獲取發布的播放器URL。</p>
        </div>
    </section>

    <section id="alterplugin" class="bcls-section">
        <h2>修改插件</h2>

        <div class="BCL-concept">
            <p>使用新的Brightcove播放器的優勢之一是，只需對插件進行一次更改即可輕鬆更新播放器，使用該插件的所有播放器都將被更新。在步驟中的這一點上，您將對插件進行少量更改，並在不更改播放器本身的情況下查看其使用情況。</p>

            <p>打開<code translate="No">first-plugin.js</code>文件並更新文本以供閱讀<strong>較新的文字！</strong></p>

            <pre class="line-numbers">
    <code class="language-javascript" translate="No">overlay.innerHTML = "NEWer TEXT!";</code></pre>
            <!-- <code data-gist-id="8939637" data-gist-hide-footer="true" data-gist-line="68"></code><br /> -->

            <p>再次將文件複製到倉庫。</p>

            <pre class="line-numbers">
    <code class="language-bash" translate="No">curl \
      --user $EMAIL \
      --form contents=@first-plugin.js \
      --request PUT \
      https://repos.api.brightcove.com/v1/accounts/{account_id}/repos/firstRepo/files/first-plugin.js</code></pre>
            <!-- <p><code data-gist-id="8939637" data-gist-hide-footer="true" data-gist-line="113-117"></code></p> -->

            <p>瀏覽相同<code translate="No">preview_url</code>從上方再次。筆記：由於瀏覽器緩存，您可能需要關閉瀏覽器選項卡，然後再次瀏覽，甚至清除瀏覽器的緩存以查看更新的文本。</p>

            <p>一旦看到插件的最新版本，您就可以發布播放器。</p>
        </div>
    </section>
</article>