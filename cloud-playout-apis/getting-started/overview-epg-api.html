---
title: '概述：電子節目單API '
parent: Getting Started 
grandparent: Cloud Playout APIs
description: This topic provides and overview of the EPG API, which is used with Cloud Playout.
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>
  <section class="bcls-section">
    <h2 id="introduction">介紹</h2>
    <p>有兩個相關的API <a href="https://studio.support.brightcove.com/cloud-playout/index.html">雲播出</a>：</p>
    <ul>
      <li>EPG API 允許您檢索 Cloud Playout 頻道的電子節目指南。Cloud Playout生成遵循XML TV標準的EPG，如以下網址中的架構所述<a href="https://repository.data2type.de/XMLTV/v_1.47/html/index.html">https://repository.data2type.de/XMLTV/v_1.47/html/index.html</a>。<aside class="bcls-aside bcls-aside--information">請務必閱讀<a href="/cloud-playout-apis/getting-started/epg-best-practices.html">電子節目單API：最佳實踐</a>以了解如何獲得最佳性能。</aside>
			</li>
      <li>Channels API 允許您檢索有關您可以在 UI 或網頁中顯示的 Cloud Playout 頻道的信息。看<a href="/cloud-playout-apis/getting-started/overview-channel-api.html">概述：渠道 API</a></li>
  </section>
  <section class="bcls-section">
    <h2 id="authentication">驗證</h2>
    <p>Cloud Playout API 使用<a href="/oauth/getting-started/overview-oauth-api-v4.html">Brightcove OAuth 系統</a>通過在授權標頭中隨請求傳遞的訪問令牌對請求進行身份驗證：</p>
    <pre><code class="language-http" translate="No">Authorization: Bearer <span class="bcls-input">{access token}</span></code></pre>
    <p>使用OAuth API檢索訪問令牌-請參閱<a href="/oauth/guides/getting-access-tokens.html">獲取訪問令牌</a>有關詳細信息。您還需要客戶端憑據來驗證對訪問令牌的請求。這些可以在 Studio 的管理部分創建 - 請參閱<a href="/general/managing-api-authentication-credentials.html">管理 API 憑證</a> .您的憑證對於 EPG API 所需的權限是：</p>
    <figure class="bcls-figure">
      <img class="bcls-image" src="/assets/images/cloud-playout/permissions-epg-api.png" alt="EPG API Permissions">
      <figcaption class="bcls-caption--image">EPG API權限</figcaption>
    </figure>
  </section>
  
  <section class="bcls-section">
    <h2 id="request_parameters">EPG請求參數</h2>
    <p>可以將以下可選查詢參數添加到 EPG 請求中：</p>
    <table class="bcls-table">
      <caption class="bcls-caption--table">EPG API查詢參數</caption>
      <thead class="bcls-table__head">
          <tr>
              <th>範圍</th>
              <th>默認值</th>
              <th>描述</th>
          </tr>
      </thead>
      <tbody class="bcls-table__body">
          <tr>
              <td><code translate="No">start</code></td>
              <td><samp translate="No">（現在前 14 天）</samp></td>
              <td>可以查詢和以 ISO 8601 日期格式返回 EPG 響應的日期時間</td>
          </tr>
          <tr>
              <td><code translate="No">end</code></td>
              <td><samp translate="No">（現在 - 當前日期時間）</samp></td>
              <td>可以查詢和以 ISO 8601 日期格式返回 EPG 響應的日期時間</td>
          </tr>
          <tr>
              <td><code translate="No">limit</code></td>
              <td><samp translate="No">（所有程序）</samp></td>
              <td>一個整數值，控制一個請求中返回的程序數。<strong>請注意，限值（默認值：100）可能會阻止返回指定時間段內的所有程序。看<a href="/cloud-playout-apis/getting-started/epg-best-practices.html">EPG API 最佳實踐</a>想要查詢更多的信息</td>
          </tr>
          <tr>
              <td><code translate="No">include_ads</code></td>
              <td><samp translate="No">錯誤的</samp></td>
              <td>將此設置為 true 以在響應中包含廣告</td>
          </tr>
      </tbody>
    </table>
    <h3>筆記</h3>
    <ol>
      <li>這<code translate="No">start</code> / <code translate="No">end</code>窗口不能超過 14 天。開始可以比當前日期時間晚 14 天以查詢歷史 EPG。您還可以從當前日期時間開始最多 14 天的未來 EPG 數據。</li>
      <li>如果結束時間和開始時間之間的差值大於14天，則API從請求的時間到結束時間僅生成14天或14天（以較早者為準）。</li>

      <li>兩個都<code translate="No">start</code>和<code translate="No">end</code>可以接受帶有和不帶有時區偏移量的日期時間值-如果不包括時區偏移量，則採用UTC。</li>
      <li>
        兩個都<code translate="No">start</code>和<code translate="No">end</code>必須使用URI編碼：
        <table class="bcls-table">
          <caption class="bcls-caption--table">URI 編碼</caption>
          <thead class="bcls-table__head">
              <tr>
                  <th>ISO 8601樣本</th>
                  <th>URI 編碼</th>
              </tr>
          </thead>
          <tbody class="bcls-table__body">
              <tr>
                  <td><code translate="No">2020-07-24 15:30:00</code></td>
                  <td><code translate="No">2020-07-24<span class="bcls-highlight">%20</span>15<span class="bcls-highlight">%3A</span>30<span class="bcls-highlight">%3A</span>00</code></td>
              </tr>
              <tr>
                  <td><code translate="No">2020-07-24 15:30:00 +0530</code></td>
                  <td><code translate="No">2020-07-24<span class="bcls-highlight">%20</span>15<span class="bcls-highlight">%3A</span>30<span class="bcls-highlight">%3A</span>00<span class="bcls-highlight">%20%2B</span>0530</code></td>
              </tr>
          </tbody>
      </table>
      </li>
    </ol>
  </section>
  <section class="bcls-section">
    <details>
      <summary><h2 id="Sample_response">示例 EPG API 響應</h2></summary>
      <p>以下是來自API的示例響應：</p>
  <pre class="line-numbers"><code class="language-xml" translate="No">&lt;?xml version="1.0" encoding="utf-8"?&gt;
    &lt;tv source-info-name="Cloudplayout Schedules" source-info-url="http://www.cloudplayout.qa.brightcove.com"&gt;
        &lt;channel id="9fb8032ff2fe4f55b388d8969c22ca58"&gt;
            &lt;display-name&gt;MyCloudChannel&lt;/display-name&gt;
            &lt;icon src="https://bc-cloudplayout-prod.s3.amazonaws.com/default_channel_image.png"/&gt;
        &lt;/channel&gt;
        &lt;programme channel="9fb8032ff2fe4f55b388d8969c22ca58" start="20201120132000" stop="20201120132228"&gt;
            &lt;title&gt;Frozen&lt;/title&gt;
            &lt;desc&gt;FrozenMultiLanguage&lt;/desc&gt;
            &lt;length units="seconds"&gt;147.605&lt;/length&gt;
            &lt;icon src="https://cf-images.us-east-1.qa.boltdns.net/v1/jit/6063799219001/43d57501-b98a-4708-bdd1-a09081f7a585/main/1280x720/1m13s802ms/match/image.jpg" width="1280" height="720"/&gt;
            &lt;category&gt;video&lt;/category&gt;
            &lt;keyword&gt;eyJ2aWRlb19pZCI6IjcwNzAwNDQxMDk2MjAyIiwib3JkZXIiOjEsInRhZ3MiOiJjaGlsZHJlbixjb21lZHkiLCJjdXN0b21fbWV0YWRhdGEiOnsicmVnaW9uIjoiYWZyaWNhIiwic29uZ3MiOjV9fQ==&lt;/keyword&gt;
        &lt;/programme&gt;
        &lt;programme channel="9fb8032ff2fe4f55b388d8969c22ca58" start="20201120132228" stop="20201120133228"&gt;
            &lt;title&gt;LiveDemo&lt;/title&gt;
            &lt;desc&gt;Live Demo&lt;/desc&gt;
            &lt;length units="seconds"&gt;600.0&lt;/length&gt;
            &lt;icon src="https://img.brightcove.com/cloudplayout/live-icon.jpg" width="1280" height="720"/&gt;
            &lt;category&gt;live&lt;/category&gt;
            &lt;keyword&gt;eyJ2aWRlb19pZCI6IjcwNzAxNDg0MjA3MjAyIiwib3JkZXIiOjIsInRhZ3MiOiJjcC1saXZlLXBsYWNlaG9sZGVyLGR1cmF0aW9uLTAwOjEwOjAwIiwiY3VzdG9tX21ldGFkYXRhIjp7InJlZ2lvbiI6Im5vcnRoIGFtZXJpY2EifX0=&lt;/keyword&gt;
        &lt;/programme&gt;
        &lt;programme channel="9fb8032ff2fe4f55b388d8969c22ca58" start="20201120133228" stop="20201120133327"&gt;
            &lt;title&gt;ChildrenComedy&lt;/title&gt;
            &lt;desc&gt;ChildrenComedy&lt;/desc&gt;
            &lt;length units="seconds"&gt;59.164&lt;/length&gt;
            &lt;icon src="https://cf-images.us-east-1.qa.boltdns.net/v1/jit/6063799219001/9430773f-76f5-476e-964d-a13b40cab90a/main/1280x720/29s582ms/match/image.jpg" width="1280" height="720"/&gt;
            &lt;category&gt;video&lt;/category&gt;
            &lt;keyword&gt;eyJ2aWRlb19pZCI6IjcwNzAxMjE2NDgyMjAyIiwib3JkZXIiOjMsInRhZ3MiOiJyb21hbmNlIiwiY3VzdG9tX21ldGFkYXRhIjp7InJlZ2lvbiI6ImFzaWEiLCJzb25ncyI6NX19&lt;/keyword&gt;
        &lt;/programme&gt;
        &lt;programme&gt;
            ...
        &lt;/programme&gt;
    &lt;/tv&gt;</code></pre>
      <h3>筆記</h3>
      <ol>
        <li>開始和結束時間戳採用 UTC 時間。</li>
        <li>這<code translate="No">category</code>和<code translate="No">keyword</code>條目用於內部目的。</li>
      </ol>
    </details>
    <p>EPG 數據包含多個節目數據，其中每個節目代表有關視頻或直播資產的詳細信息：</p>
<pre class="line-numbers"><code class="language-xml">&lt;programme channel="27963aa756294a7c98ca1c2c459d4ba2" start="20201118232206" stop="20201118232305"&gt; &lt;title&gt;ChildrenComedy&lt;/title&gt; &lt;desc&gt;ChildrenComedy&lt;/desc&gt;&lt;icons16"&gt;&lt;iconlength&gt;&lt;iconlength&gt;&lt;59&gt; &gt; src="https://cf-images.us-east-1.qa.boltdns.net/v1/jit/6063799219001/9430773f-76f5-476e-964d-a13b40cab90a/main/1280x720/29s5 JPG“寬度=”1280“HEIGHT =”720“&gt; &lt;/圖標&gt; &lt;類別&gt;視頻&lt;/類別&gt; &lt;關鍵字&gt; eyJ2aWRlb19pZCI6IjcwNzAxMjE2NDgyMjAyIiwib3JkZXIiOjEsInRhZ3MiOiJjaGlsZHJlbixjb21lZHkiLCJjdXN0b21fbWV0YWRhdGEiOnsicmVnaW9uIjoiYWZyaWNhIiwic29uZ3MiOjV9fQ == &lt;/關鍵字&gt; &lt;/節目&gt;</code></pre>
    <p>在這裡，<code translate="No">keyword</code>包含base64編碼的json值。的解碼值<code translate="No">keyword</code>如下所示。</p>
    <ul>
      <li><code translate="No">video_id</code>：是視頻雲中視頻的標識符。</li>

      <li><code translate="No">order</code>：是Cloud Playout程序列表中資產的順序。 </li>

      <li><code translate="No">tags</code>：逗號分隔（如果有）-與視頻雲中的相應視頻相關聯。</li>

      <li>自定義元數據：（如果有的話，表示為名稱/值對）與視頻雲中的相應視頻相關聯。</li> 
    </ul>
<pre class="line-numbers"><code class="language-json" translate="No">{
  "video_id":"70701216482202",
  "order":1,
  "tags":"children,comedy",
  "custom_metadata":{
    "region":"africa",
    "songs":5
  }
}</code></pre>
  </section>
  
  <section class="bcls-section">
  <h2 id="epg_bumpers">EPG 和保險槓</h2>
  <h3>EPG如何處理保險槓</h3>
  <p>EPG 不包括保險槓本身。保險槓的持續時間將通過以下方式反映：</p>
  <ul>
    <li>滾動前保險槓時長被添加到<strong>下列的</strong>視頻時長</li>
    <li>防滾後保險槓的持續時間已添加到<strong>以前的</strong>視頻時長</li>
  </ul>
  <h3>潛在問題</h3>
  <p>您可以做兩件事會導致 EPG 不准確：</p>
  <ul>
    <li>將視頻標記為前貼片 ( <code translate="No">cp-preroll-bumper</code> ) <strong>和</strong>後卷（<code translate="No">cp-postroll-bumper</code> ) 會導致 EPG 不准確，因為它取決於標籤來決定在哪裡添加持續時間。如果視頻同時具有兩個標籤，則保險槓時長將同時添加到上一個和下一個視頻中。</li>
    <li>您可以在 Cloud Playout 節目列表中移動導視廣告，但如果您將它們排列成前貼片導視廣告緊跟在後貼片導覽廣告之後，兩個導覽廣告都會播放，但 EPG API 將忽略它們及其時間表時間段將為空。</li>
  </ul>
</section>
  <section class="bcls-section">
    <h2 id="limitations">局限性</h2>
    <ol>
      <li>EPG 是盡最大努力/接近準確生成的。</li>
      <li>當最初從播放列表構建 EPG 時，可能存在開始時間錯誤，因為 Cloud Playout 需要一些時間來啟動切換。</li>
      <li>
        修改播放列表時，EPG可能對每個檢索都不一致，因為它是根據所保存的當前信息動態構建的。一些會改變 EPG 的操作包括重新排列播放列表或添加/刪除播放列表中的資產。
      </li>
      <li>如果在切換中發生任何故障並且切換時間不正確，則可能是將來的EPG的運輸不准確。可能導致這種情況的一些操作示例是播放列表切換或刪除播放列表中的當前活動資產。</li>
      <li>EPG的消費者應該要求它盡可能接近實時，以獲取最準確的版本。</li>
    </ol>
  </section>
</article>